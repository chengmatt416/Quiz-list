<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>最終測試：完整資料讀取檢查</title>
</head>
<body>
    <h1>最終測試：完整資料讀取</h1>
    <p>這個頁面應該會成功列出全部 40 份考卷的章節名稱。如果成功，代表資料本身沒有問題。</p>
    <ul id="list"></ul>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // 這是完整的考卷清單資料
        const initialData = [
            { id: 1, subject: "數", chapter: "1-3", questions: 70, completed: false, corrected: false, dueDate: null },
            { id: 2, subject: "數", chapter: "1-4", questions: 70, completed: false, corrected: false, dueDate: null },
            { id: 3, subject: "數", chapter: "2-1", questions: 70, completed: false, corrected: false, dueDate: null },
            { id: 4, subject: "數", chapter: "2-2", questions: 70, completed: false, corrected: false, dueDate: null },
            { id: 5, subject: "地", chapter: "L1", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 6, subject: "地", chapter: "L2", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 7, subject: "歷", chapter: "L1", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 8, subject: "歷", chapter: "L2", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 9, subject: "公", chapter: "L1", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 10, subject: "公", chapter: "L2", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 11, subject: "國", chapter: "L3", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 12, subject: "國", chapter: "L4", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 13, subject: "國", chapter: "語文天地", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 14, subject: "國", chapter: "自學1", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 15, subject: "理", chapter: "1-1&1-2", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 16, subject: "理", chapter: "1-3", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 17, subject: "理", chapter: "1-4", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 18, subject: "理", chapter: "2-1&2-2", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 19, subject: "理", chapter: "1-1&1-2", questions: 80, completed: false, corrected: false, dueDate: null },
            { id: 20, subject: "理", chapter: "1-3&1-4", questions: 80, completed: false, corrected: false, dueDate: null },
            { id: 21, subject: "歷", chapter: "L1", questions: 70, completed: false, corrected: false, dueDate: null },
            { id: 22, subject: "歷", chapter: "L2", questions: 70, completed: false, corrected: false, dueDate: null },
            { id: 23, subject: "地", chapter: "L1", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 24, subject: "地", chapter: "L2", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 25, subject: "公", chapter: "L1", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 26, subject: "公", chapter: "L2", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 27, subject: "歷", chapter: "L1", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 28, subject: "歷", chapter: "L2", questions: 50, completed: false, corrected: false, dueDate: null },
            { id: 101, subject: "數", chapter: "複習講義訂正", questions: 1, completed: false, corrected: false, dueDate: null },
            { id: 102, subject: "數", chapter: "進度講義訂正", questions: 1, completed: false, corrected: false, dueDate: null },
            { id: 103, subject: "地", chapter: "複習講義訂正", questions: 1, completed: false, corrected: false, dueDate: null },
            { id: 104, subject: "地", chapter: "進度講義訂正", questions: 1, completed: false, corrected: false, dueDate: null },
            { id: 105, subject: "歷", chapter: "複習講義訂正", questions: 1, completed: false, corrected: false, dueDate: null },
            { id: 106, subject: "歷", chapter: "進度講義訂正", questions: 1, completed: false, corrected: false, dueDate: null },
            { id: 107, subject: "公", chapter: "複習講義訂正", questions: 1, completed: false, corrected: false, dueDate: null },
            { id: 108, subject: "公", chapter: "進度講義訂正", questions: 1, completed: false, corrected: false, dueDate: null },
            { id: 109, subject: "國", chapter: "複習講義訂正", questions: 1, completed: false, corrected: false, dueDate: null },
            { id: 110, subject: "國", chapter: "進度講義訂正", questions: 1, completed: false, corrected: false, dueDate: null },
            { id: 111, subject: "理", chapter: "複習講義訂正", questions: 1, completed: false, corrected: false, dueDate: null },
            { id: 112, subject: "理", chapter: "進度講義訂正", questions: 1, completed: false, corrected: false, dueDate: null },
        ];
        
        const listElement = document.getElementById('list');

        if (listElement) {
            try {
                let itemsFound = [];
                initialData.forEach(function(item) {
                    if (item && item.chapter) {
                        itemsFound.push(item.chapter);
                    } else {
                        // If an item is malformed, we add a note to find it
                        itemsFound.push("!!! ERROR: An item was found without a chapter !!!");
                    }
                });
                
                // Display all found chapters
                listElement.innerHTML = '<li>' + itemsFound.join('</li><li>') + '</li>';
                
                // Display a success or failure message
                const p = document.createElement('p');
                if (itemsFound.length === initialData.length) {
                    p.style.color = 'green';
                    p.textContent = '測試成功：成功讀取並顯示了全部 ' + itemsFound.length + ' 個項目！';
                } else {
                    p.style.color = 'red';
                    p.textContent = '測試失敗：預期讀取 ' + initialData.length + ' 個項目，但只成功 ' + itemsFound.length + ' 個。';
                }
                document.body.appendChild(p);

            } catch (error) {
                alert('執行資料讀取時發生了未預期的錯誤: ' + error.message);
            }
        } else {
            alert('錯誤：找不到ID為 "list" 的清單元件。');
        }
    });
    </script>
</body>
</html>
